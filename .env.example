# ===========================
# CinePulse â€” .env.example
# Bollywood + Hindi TV/OTT scope
# Copy to .env and adjust.
# ===========================

# ---------- Core ----------
ENV=prod
TZ=Asia/Kolkata
LOG_LEVEL=INFO
LANG=C.UTF-8
PYTHONUNBUFFERED=1

# ---------- Storage / Queues ----------
DATABASE_URL=postgresql+psycopg://postgres:postgres@db:5432/cinepulse
REDIS_URL=redis://redis:6379/0

# Rolling feed (Redis)
FEED_KEY=feed:items
SEEN_KEY=feed:seen
FEED_MAX=1200
MAX_SCAN=400

# Scope guard (belt-and-suspenders)
FEED_ALLOWED_INDUSTRIES=bollywood

# ---------- API pagination / rate limits ----------
BATCH_SIZE=200
RL_FEED_PER_MIN=120
RL_SEARCH_PER_MIN=90
RL_STORY_PER_MIN=240

# ---------- Summarizer knobs ----------
SUMMARY_TARGET_WORDS=85
SUMMARY_MIN_WORDS=60
SUMMARY_MAX_WORDS=110
# Short-body passthrough thresholds (used by apps/workers/jobs.py)
SUMMARY_PASSTHROUGH_MIN_CHARS=220
SUMMARY_PASSTHROUGH_MAX_CHARS=1200
SUMMARY_PASSTHROUGH_MIN_SENTENCES=2

# ---------- Observability ----------
SENTRY_DSN_BACKEND=

# ---------- External APIs ----------
# (fill real tokens in your private .env, never commit)
YOUTUBE_API_KEY=
TMDB_API_KEY=
OMDB_API_KEY=
FCM_SERVER_KEY=

# ---------- Service URLs ----------
# Public URL where browsers/devices reach your API
API_PUBLIC_BASE_URL=https://api.cinepulse.example.com
# Internal URL for inter-container calls
API_INTERNAL_BASE_URL=http://api:8000
# Optional HTML/image renderer
RENDERER_URL=http://renderer:8000

# Allow-listed origins (comma-separated, no spaces)
# Keep both spellings if your Netlify site uses "cinepusle" (typo) now.
CORS_ORIGINS=*,https://cinepusle.netlify.app,https://cinepulse.netlify.app,https://api.cinepulse.example.com

# Deep-link base used by the Flutter web app (/#!/s/<id>)
DEEP_LINK_BASE=https://cinepusle.netlify.app/#/s

# ---------- Scheduler / Ingestion ----------
# NOTE: With infra/source.yml (use_sources_file: true), these lists are ignored.
# Keep for local quick tests only.
YT_CHANNELS=UCq-Fj5jknLsUf-MWSy4_brA,UCI5q9xeOp2-1bV7xEtkKgzA,UCQ7oCq4qjTLnkaW3r4U1H0g,UCwo9ey4fQ8h0c8rQ2n2-2sw
RSS_FEEDS=https://www.bollywoodhungama.com/rss/news.xml,https://www.filmcompanion.in/feed,https://www.pinkvilla.com/entertainment/feed,https://www.koimoi.com/feed/,https://www.tellyupdates.com/feed/

POLL_INTERVAL_MIN=15
PUBLISHED_AFTER_HOURS=72
POLL_SPREAD_SEC=2.0
POLL_JITTER_SEC=10
YT_MAX_ITEMS=50
RSS_MAX_ITEMS=200
ONE_SHOT=false

ENABLE_YOUTUBE_INGEST=true
ENABLE_RSS_INGEST=true
ENABLE_TMDB_INGEST=true

# ---------- Notes ----------
# - Compose already mounts ../.env; keep this file at repo root.
# - When you change this file:
#     docker compose -f infra/compose.yml up -d --build
# - To purge the rolling feed:
#     docker compose -f infra/compose.yml exec redis redis-cli -n 0 DEL feed:items
